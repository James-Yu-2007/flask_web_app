name: Super-Linter

on: push

jobs:
  super-lint:
    name: Lint code base
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Run Super-Linter
        run: |
          # run pipeline

          if [ ! -d "database" ]
          then
            mkdir database
            if [ $? -ne 0 ]
            then
              echo "FATAL: database created unsuccessfully"
              exit 1
            fi
          fi
          yes | sudo apt install python3 && sudo apt install python3-pip && sudo pip3 install flask && sudo pip3 install flask-login && sudo pip3 install flask-sqlalchemy
          if [ $? -ne 0 ]
          then
            echo "FATAL: packages downloaded unsuccessfully"
            exit 2
          fi

          export DB_PATH=database/database.db
          echo Finished exporting DB_PATH

          cd flask_web_app-1.3 && nohup python3 flask_web_app-1.3/main.py > console.log &
          if [ $? -ne 0 ]
          then
            echo $DB_PATH
            exit 3
          fi
          echo SUCCESS
          cat console.log

